#include<SDL.h>
#include<stack>
#include<cstdlib>
#include<cstdint>
#include<iostream>

class chip8{
	public:
	uint8_t Memory[4096];
	uint8_t Reg[16];
	uint8_t displayBuffer[64*32];
	uint16_t PC;
	uint16_t Index;
	uint8_t Delay_timer, Sound_timer;
	std::stack<uint16_t> _stack;
	unsigned char charset[80] = {
	    0xF0 ,0x90, 0x90, 0x90, 0xF0, //0
	    0x20, 0x60, 0x20, 0x20, 0x70, //1
	    0xF0, 0x10, 0xF0, 0x80, 0xF0, //2
	    0xF0, 0x10, 0xF0, 0x10, 0xF0, //3
	    0x90, 0x90, 0xF0, 0x10, 0x10, //4
	    0xF0, 0x80, 0xF0, 0x10, 0xF0, //5
	    0xF0, 0x80, 0xF0, 0x90, 0xF0, //6
	    0xF0, 0x10, 0x20, 0x40, 0x40, //7
	    0xF0, 0x90, 0xF0, 0x90, 0xF0, //8
	    0xF0, 0x90, 0xF0, 0x10, 0xF0, //9
	    0xF0, 0x90, 0xF0, 0x90, 0x90, //A
	    0xE0, 0x90, 0xE0, 0x90, 0xE0, //B
	    0xF0, 0x80, 0x80, 0x80, 0xF0, //C
	    0xE0, 0x90, 0x90, 0x90, 0xE0, //D
	    0xF0, 0x80, 0xF0, 0x80, 0xF0, //E
	    0xF0, 0x80, 0xF0, 0x80, 0x80  //F
	};
	bool draw, state;
	uint8_t error;	
	SDL_Surface *display;
	SDL_Event event;

	chip8(const std::string &file);
	void init();
	void read(const std::string &file);
	void reset();
	void run();
	void cycle();
	void render();
	void decode(uint16_t opcode);
};
